import FabricBaseHub from 'msg-fabric-core/esm/core.js'
import mfpi_standard from 'msg-fabric-core/esm/mfpi-standard.js'
import mfpi_cbor from 'msg-fabric-core/esm/mfpi-cbor.js'

import mfpi_direct from 'msg-fabric-core/esm/mfpi-direct.js'
import mfpi_web from 'msg-fabric-core/esm/mfpi-web.js'
import mfpi_rpc from 'msg-fabric-core/esm/mfpi-rpc.js'

let mfpis = [
  mfpi_standard(),
  mfpi_direct(),
  mfpi_web(),
  mfpi_rpc(),
]

#IF PLAT_WEB
  import mfpi_ids_web from 'msg-fabric-core/esm/mfpi-ids-web.js'
  mfpis.push(mfpi_ids_web())

#IF PLAT_NODEJS
  import mfpi_ids_node from 'msg-fabric-core/esm/mfpi-ids-node.js'
  import mfpi_direct_stream from 'msg-fabric-core/esm/mfpi-net-stream.js'
  import mfpi_tcp_stream from 'msg-fabric-core/esm/mfpi-net-tcp.js'
  import mfpi_tls_stream from 'msg-fabric-core/esm/mfpi-net-tls.js'

  mfpis.push(
    mfpi_ids_node(),
    mfpi_tcp_stream(),
    mfpi_tls_stream(),
    mfpi_direct_stream(),
  )

const FabricHub = FabricBaseHub.plugin(... mfpis)
const FabricHubCBOR = FabricHub.plugin @ mfpi_cbor()


import { _init } from './unit/_setup.jsy'
_init(FabricHub, FabricHubCBOR)

export * from './unit/all.jsy'

