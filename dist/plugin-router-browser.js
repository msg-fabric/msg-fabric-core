'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var msgFabricPacketStream = require('msg-fabric-packet-stream');

function browser_router_plugin(plugin_options = {}) {
  return { order: -2, subclass(FabricHub_PI, bases) {
      Object.assign(FabricHub_PI.prototype, {
        packetParser: msgFabricPacketStream.createDataViewPacketParser(plugin_options),

        _init_router() {
          const id_self = random_id_self();
          const router = new bases.Router(id_self);
          router.allowUnverifiedRoutes = true;
          return router;
        } });
    } };
}

function random_id_self() {
  const ua = new Int32Array(1),
        dv = new DataView(ua.buffer);
  if ('undefined' !== typeof window) {
    window.crypto.getRandomValues(ua);
  } else {
    ua[0] = 0xffffffff * Math.random();
  }
  return dv.getInt32(0, true);
}

exports['default'] = browser_router_plugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGx1Z2luLXJvdXRlci1icm93c2VyLmpzIiwic291cmNlcyI6WyIuLi9jb2RlL3BsdWdpbnMvcm91dGVyL2Jyb3dzZXIuanN5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Y3JlYXRlRGF0YVZpZXdQYWNrZXRQYXJzZXIgYXMgY3JlYXRlUGFja2V0UGFyc2VyfSBmcm9tICdtc2ctZmFicmljLXBhY2tldC1zdHJlYW0nXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGJyb3dzZXJfcm91dGVyX3BsdWdpbihwbHVnaW5fb3B0aW9ucz17fSkgOjpcbiAgcmV0dXJuIEA6IG9yZGVyOiAtMiwgc3ViY2xhc3MoRmFicmljSHViX1BJLCBiYXNlcykgOjpcbiAgICBPYmplY3QuYXNzaWduIEAgRmFicmljSHViX1BJLnByb3RvdHlwZSwgQDpcbiAgICAgIHBhY2tldFBhcnNlcjogY3JlYXRlUGFja2V0UGFyc2VyIEAgcGx1Z2luX29wdGlvbnNcblxuICAgICAgX2luaXRfcm91dGVyKCkgOjpcbiAgICAgICAgY29uc3QgaWRfc2VsZiA9IHJhbmRvbV9pZF9zZWxmKClcbiAgICAgICAgY29uc3Qgcm91dGVyID0gbmV3IGJhc2VzLlJvdXRlcihpZF9zZWxmKVxuICAgICAgICByb3V0ZXIuYWxsb3dVbnZlcmlmaWVkUm91dGVzID0gdHJ1ZVxuICAgICAgICByZXR1cm4gcm91dGVyXG5cbmZ1bmN0aW9uIHJhbmRvbV9pZF9zZWxmKCkgOjpcbiAgY29uc3QgdWEgPSBuZXcgSW50MzJBcnJheSgxKSwgZHYgPSBuZXcgRGF0YVZpZXcodWEuYnVmZmVyKVxuICBpZiAndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHdpbmRvdyA6OlxuICAgIHdpbmRvdy5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHVhKVxuICBlbHNlIDo6XG4gICAgdWFbMF0gPSAweGZmZmZmZmZmICogTWF0aC5yYW5kb20oKVxuICByZXR1cm4gZHYuZ2V0SW50MzIoMCwgdHJ1ZSlcbiJdLCJuYW1lcyI6WyJicm93c2VyX3JvdXRlcl9wbHVnaW4iLCJwbHVnaW5fb3B0aW9ucyIsIm9yZGVyIiwic3ViY2xhc3MiLCJGYWJyaWNIdWJfUEkiLCJiYXNlcyIsImFzc2lnbiIsInByb3RvdHlwZSIsImNyZWF0ZVBhY2tldFBhcnNlciIsImlkX3NlbGYiLCJyYW5kb21faWRfc2VsZiIsInJvdXRlciIsIlJvdXRlciIsImFsbG93VW52ZXJpZmllZFJvdXRlcyIsInVhIiwiSW50MzJBcnJheSIsImR2IiwiRGF0YVZpZXciLCJidWZmZXIiLCJ3aW5kb3ciLCJjcnlwdG8iLCJnZXRSYW5kb21WYWx1ZXMiLCJNYXRoIiwicmFuZG9tIiwiZ2V0SW50MzIiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUVlLFNBQVNBLHFCQUFULENBQStCQyxpQkFBZSxFQUE5QyxFQUFrRDtTQUN0RCxFQUFDQyxPQUFPLENBQUMsQ0FBVCxFQUFZQyxTQUFTQyxZQUFULEVBQXVCQyxLQUF2QixFQUE4QjthQUMxQ0MsTUFBUCxDQUFnQkYsYUFBYUcsU0FBN0IsRUFBMEM7c0JBQzFCQyxpREFBcUJQLGNBQXJCLENBRDBCOzt1QkFHekI7Z0JBQ1BRLFVBQVVDLGdCQUFoQjtnQkFDTUMsU0FBUyxJQUFJTixNQUFNTyxNQUFWLENBQWlCSCxPQUFqQixDQUFmO2lCQUNPSSxxQkFBUCxHQUErQixJQUEvQjtpQkFDT0YsTUFBUDtTQVBzQyxFQUExQztLQURPLEVBQVQ7OztBQVVGLFNBQVNELGNBQVQsR0FBMEI7UUFDbEJJLEtBQUssSUFBSUMsVUFBSixDQUFlLENBQWYsQ0FBWDtRQUE4QkMsS0FBSyxJQUFJQyxRQUFKLENBQWFILEdBQUdJLE1BQWhCLENBQW5DO01BQ0csZ0JBQWdCLE9BQU9DLE1BQTFCLEVBQW1DO1dBQzFCQyxNQUFQLENBQWNDLGVBQWQsQ0FBOEJQLEVBQTlCO0dBREYsTUFFSztPQUNBLENBQUgsSUFBUSxhQUFhUSxLQUFLQyxNQUFMLEVBQXJCOztTQUNLUCxHQUFHUSxRQUFILENBQVksQ0FBWixFQUFlLElBQWYsQ0FBUDs7Ozs7In0=
