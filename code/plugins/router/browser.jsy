export default function browser_router_plugin(plugin_options={}) ::
  return @: order: -2, subclass(FabricHub_PI) ::
    Object.assign @ FabricHub_PI.prototype, @{}
      _newRouteId

const max_id = parseInt('zzzzzz', 36)
function _newRouteId() ::
  if 'undefined' === typeof window ::
    return (0 | Math.random() * max_id).toString(36)

  const ua = new Uint32Array(1)
  while 1 ::
    window.crypto.getRandomValues(ua)
    if ua[0] <= max_id ::
      return ua[0].toString(36)
