
export function sleep(ms, ctx) ::
  return new Promise @ resolve => setTimeout(resolve, ms, ctx)

export function promiseQueue(nextPromise=() => Promise.resolve()) ::
  let tip = null
  return function () ::
    if null === tip ::
      tip = nextPromise()
      tip.then @ clear_tip
    return tip

  function clear_tip() ::
    tip = null

